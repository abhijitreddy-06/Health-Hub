<!DOCTYPE html>
<html>

<head>
    <title>My Records</title>
</head>

<body>

    <h2>My Medical Records</h2>

    <button onclick="openUpload()">Upload Record</button>

    <form id="uploadForm" action="/vault/upload" method="POST" enctype="multipart/form-data" style="display:none">
        <input type="file" name="file" required />
        <select name="recordType">
            <option value="general">General</option>
            <option value="prescription">Prescription</option>
            <option value="report">Report</option>
        </select>
        <button type="submit">Upload</button>
    </form>

    <ul id="records"></ul>

    <script>
        async function loadRecords() {
            const res = await fetch("/api/vault/user");
            const data = await res.json();

            const list = document.getElementById("records");
            list.innerHTML = "";

            data.forEach(r => {
                const li = document.createElement("li");
                li.innerHTML = `
            ${r.file_name} (${r.record_type})
            <a href="/vault/file/${r.id}">Download</a>
        `;
                list.appendChild(li);
            });
        }

        function openUpload() {
            document.getElementById("uploadForm").style.display = "block";
        }

        loadRecords();
    </script>

</body>

</html>