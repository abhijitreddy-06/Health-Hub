<form action="/appointments/book" method="POST" class="appointment-form">

    <label>Select Doctor</label>
    <select name="doctorId" id="doctorSelect" required>
        <option value="">Loading doctors...</option>
    </select>

    <label>Date</label>
    <input type="date" name="date" required />

    <label>Time</label>
    <input type="time" name="time" required />

    <button type="submit">Book Appointment</button>
</form>

<script>
    async function loadDoctors() {
        try {
            const res = await fetch("/api/doctors");
            const doctors = await res.json();

            const select = document.getElementById("doctorSelect");
            select.innerHTML = '<option value="">Select Doctor</option>';

            doctors.forEach(doc => {
                const opt = document.createElement("option");
                opt.value = doc.id;
                opt.textContent = `${doc.full_name} (${doc.specialization})`;
                select.appendChild(opt);
            });
        } catch (err) {
            console.error("Failed to load doctors", err);
        }
    }

    loadDoctors();
</script>