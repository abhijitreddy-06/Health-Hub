<!DOCTYPE html>
<html>

<head>
    <title>Patient Records</title>
</head>

<body>

    <h2>Patient Medical Records</h2>

    <ul id="records"></ul>

    <script>
        const appointmentId = new URLSearchParams(window.location.search).get("appointmentId");

        async function loadRecords() {
            const res = await fetch(`/api/vault/doctor/${appointmentId}`);
            if (!res.ok) {
                document.body.innerHTML = "<h3>Access denied</h3>";
                return;
            }

            const data = await res.json();
            const ul = document.getElementById("records");

            data.forEach(r => {
                const li = document.createElement("li");
                li.innerHTML = `
            ${r.file_name} (${r.record_type})
            <a href="/vault/file/${r.id}">Download</a>
        `;
                ul.appendChild(li);
            });
        }

        loadRecords();
    </script>

</body>

</html>